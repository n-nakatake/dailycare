# 変更を本番環境に反映する手順
1. 開発環境で変更を実装し、`git push`する
2. 本番環境のEC2に入って（入り方は下記`パスワードを忘れた場合の再設定手順`を参照）、`~/environment/dailycare`まで移動した後、`git pull`する
3. 設定ファイル等をいじらない限りはこれで本番環境に変更が反映される（画面上ですぐに変更を反映したい場合にはブラウザのキャッシュを削除する）
4. 設定ファイルをいじった時には`php artisan config:clear`で設定ファイルのキャッシュを削除する

# 事業所の最初のユーザーを登録するページ
dc360.iroiro-inc.com/register

# パスワードを忘れた場合の再設定手順

1. 以下の手順で対象ユーザーのパスワードを変更する

```
### 鍵ファイルの場所まで移動してEC2に接続する
cd [鍵ファイル（dc360_production_osaka.cer）のあるディレクトリ]
ssh ec2-user@15.168.22.101 -i ./dc360_production_osaka.cer

### tinkerを起動する
$ cd ~/environment/dailycare
$ php artisan tinker

### ユーザーIDがわかる場合、ユーザーIDで指定してパスワードを'abcd1234'(他のパスワードでもよい)に設定する
>>> User::where('user_code', 'sato')->update(['password' => Hash::make('abcd1234')]);

### ユーザーIDがわからない場合、全ユーザーを表示してユーザーのユーザーIDを確認し、パスワードを'abcd1234'(他のパスワードでもよい)に設定する
>>> User::all();
>>> User::where('user_code', 'sato')->update(['password' => Hash::make('abcd1234')]);
```

2. パスワードを忘れたユーザーに、仮パスワード'abcd1234'でログインしてもらい、自分でパスワード変更してもらう


# バックアップからのEC2作り直し手順

1. AWSのコンソール画面にアクセスする
2. EC2一覧画面に遷移
3. リージョンを大阪に変更（既に大阪なら4へ）
4. 左メニューのAMIをクリック
5. 最新の、またはEC2を復元したい日に作成されたAMIを選択する
6. 右上の`AMIからインスタンスを起動`ボタンを押す
7. インスタンスの設定画面で名前に`dc360_production`、アプリケーションおよび OS イメージに`自分のAMI`を選択し、復元したいAMIを選択する
8. インスタンスタイプはそのまま、キーペアは`dc360_production_osaka`を使用
9. セキュリティグループは`既存のセキュリティグループを利用`を選択し、共通のセキュリティグループで`launch-wizard-1`を選択
10. ストレージ設定はそのままで、右下の`インスタンスを起動`ボタンを押す（自動的にEC2インスタンスとEBSボリュームが作成される）
11. インスタンスとEBSボリュームが作成されたら、左メニューのElastic　IPをクリック
12. `15.168.22.101`のEIPを選択し、アクションから`Elastic IPアドレスの関連付けの解除`を選択
13. `15.168.22.101`のEIPを選択し、アクションから`Elastic IPアドレスの関連付け`を選択
14. 新しく作成したインスタンスに`15.168.22.101`を関連づける
15. dc360のサイトURLにアクセスして動作確認をする
16. 不要になったEC2とEBSボリュームがあれば削除する
